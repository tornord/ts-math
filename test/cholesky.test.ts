import { cholesky } from "../src";

describe("cholesky", () => {
  it("cholesky", () => {
    const res1 = cholesky([
      [6, 15, 55],
      [15, 55, 225],
      [55, 225, 979],
    ]);
    expect(res1).to.deep.equal([
      [2.449489742783178, 0, 0],
      [6.123724356957946, 4.183300132670377, 0],
      [22.45365597551247, 20.916500663351886, 6.110100926607781],
    ]);

    const res2 = cholesky([
      [1, 0.6, 0.1],
      [0.6, 1, 0.5],
      [0.1, 0.5, 1],
    ]);
    expect(res2).to.deep.equal([
      [1,0,0],
      [0.6,0.8,0],
      [0.1,0.5499999999999999,0.82915619758885]
    ]);

    const res3 = cholesky([
      [4, 12, -16],
      [12, 37, -43],
      [-16, -43, 98],
    ]);
    expect(res3).to.deep.equal([
      [2,0,0],
      [6,1,0],
      [-8,5,3]
    ]);

    const res4 = cholesky([
      [1,0.6],[0.6,1]
    ]);
    expect(res4).to.deep.equal([
      [1,0],
      [.6,.8]
    ]);
  });
});
